<link rel="import" href="../elements.html">

<dom-module id="new-episode">
	<style>
		:host {
			height: 100%;
			width: 100%;
			display: block;
			position: relative;
			font-family: 'Roboto', sans-serif;
			-webkit-font-smoothing: antialiased;
			text-rendering: optimizeLegibility;
		}
		.playerloc {
			position: relative;
			display: block;
			height: 150px;
			margin-top: 50px;
		}
		podcast-player {
			position: absolute;
			bottom: 0;
		}
		
		.episode-info h1{
			color: var(--primary-text-color);
			font-weight: 100;
			margin-top: 10px;
		}
		.episode-info h5{
			color: var(--secondary-text-color);
			font-weight: 100;
			margin-bottom: 0;
		}
		
		.resources {
			display: block;
		}
		.resources h3 {
			font-weight: 100;
			font-size: 20px;
		}
		.resources paper-material {
			margin:0;
		}
		.resources paper-item {
			padding: 10px 20px;
			margin: 1px;
			color: var(--secondary-text-color);
		}
		.resources .item-title {
			font-weight: 100;
			font-size: 16sp;
			overflow: hidden;
			text-overflow: ellipsis;
		}
		.resources .item-link {
			font-weight: 100;
			font-size: 14sp;
			overflow: hidden;
			text-overflow: ellipsis;
		}
		.resources .item-link a {
			color: var(--secondary-text-color);
		}
		
		@media all and (min-width: 0) and (max-width: 600px) {
			.resources paper-material {
				width: auto;
				display: block;
			}
			.episode-info {
				margin: 20px;
				padding: 10px;
			}
			.episode-coverart {
				width: 80px;
				height: 80px;
			}
			.episode-info h1{
				font-size: 30px;
			}
			.episode-info h5{
				margin-top: 0;
			}
		}
		@media all and (min-width: 601px) {
			.resources paper-material {
				width: 49%;
				display: inline-block;
			}
			.episode-info {
				margin: 50px;
				padding: 20px;
			}
			.episode-coverart {
				width: 120px;
				height: 120px;
			}
			.episode-info h1{
				font-size: 40px;
			}
			.episode-info h5{
				margin-top: 40px;
			}
		}
		
	</style>
	<template>
		<iron-localstorage name="content" value="{{localstoragecontent}}"></iron-localstorage>
		<iron-ajax id="contentservice"
				auto
				url="http://localhost:3000/content.json"
				handle-as="json"
				on-response="_handleContentResponse"></iron-ajax>
		<paper-material class="episode-info" elevation="1">
			<div class="titlebar layout horizontal">
				<div class="flex layout vertical">
					<h5>Episode <span>{{content.episode}}</span></h5>
					<h1 class="flex">{{content.title}}</h1>
				</div>
				<div>
					<iron-image class="episode-coverart"	src="{{content.coverart}}" sizing="contain"></iron-image>
				</div>
			</div>
			<div class="summary">
				<p>{{content.summary}}</p>
			</div>
			<div class="layout vertical resources">
				<div>
					<h3>Resources</h3>
				</div>
				<div class="block">
					<template is="dom-repeat" items="{{content.resources}}">
						<paper-material elevation="1">
							<paper-item>
								<paper-item-body two-line>
									<div class="item-title">{{item.title}}</div>
									<div secondary class="item-link"><a href="{{item.link}}">{{item.link}}</a></div>
								</paper-item-body>
							</paper-item>
						</paper-material>
					</template>
				</div>
			</div>
		</paper-material>
		<div class="playerloc">
			<podcast-player
				src="http://traffic.libsyn.com/thewebplatform/episode-53_diving-into-angular-2.mp3"
				name="Diving into Angular 2"
				coverart="http://assets.libsyn.com/content/9454132"
  			episode="53"></podcast-player>
		</div>
	</template>
</dom-module>
<script>
	( function() {
		Polymer({
			is: 'new-episode',
			properties: {
				localstoragecontent: {
					type: Object,
					observer: '_updateContent'
				},
				content: {
					type: Object,
					value: []
				}
			},
			_updateContent: function () {
				this.content = this.localstoragecontent[0];
			},
			_handleContentResponse: function (e, detail) {
				this.localstoragecontent = detail.response;
			}
		});
	})();
</script>